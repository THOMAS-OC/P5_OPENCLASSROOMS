const url=new URL(location.href),id=url.searchParams.get("id"),elementPicture=document.querySelector(".item__img"),elementTitle=document.getElementById("title"),elementDescription=document.getElementById("description"),elementPrice=document.getElementById("price"),elementChoiceColors=document.getElementById("colors"),quantity=document.getElementById("quantity"),button=document.getElementById("addToCart");fetch(`http://localhost:3000/api/products/${id}`).then(e=>{if(!0===e.ok)e.json().then(e=>{console.log(e),elementTitle.innerText=e.name,elementPrice.innerText=e.price,elementDescription.innerText=e.description;let t=document.createElement("img");t.src=e.imageUrl,t.alt=e.altTxt,elementPicture.appendChild(t),document.title=e.name;for(let t of e.colors){let e=document.createElement("option");e.value=t,e.innerText=t,elementChoiceColors.appendChild(e)}});else{alert("Le produit est introuvable, nous vous redirigeons vers la page d'accueil"),console.log(location.href),console.log(location.href.indexOf("html/"));let e=location.href.slice(0,location.href.indexOf("html/")+4);e+="/index.html",console.log(e),location.assign(e)}}),button.addEventListener("click",()=>{if(elementChoiceColors.value)if(parseInt(quantity.value))if(quantity.value<1||quantity.value>100)alert("Veuillez saisir un nombre entre 1 et 100 dans le champs 'nombre d'articles' svp");else{let e=`${id} ${elementChoiceColors.value}`,t=quantity.value;if(t=parseInt(t),console.log(t),console.log(e),localStorage.getItem(e)){alert("Quantité d'article modifée !");let l=localStorage.getItem(e),n=(l=parseInt(l))+t;localStorage.removeItem(e),localStorage.setItem(e,n)}else alert("Article ajouté au panier !"),localStorage.setItem(e,t)}else alert("Veuillez saisir un nombre dans le champs 'nombre d'articles' svp");else alert("Veuillez sélectionner une couleur")});